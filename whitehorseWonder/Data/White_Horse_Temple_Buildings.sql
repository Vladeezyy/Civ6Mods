-- White_Horse_Temple_Buildings
-- Author: yiboy
-- DateCreated: 6/5/2024 12:22:24 AM
--------------------------------------------------------------
INSERT INTO Types 
	(Type,							Kind) 
VALUES	
	('BUILDING_WHITE_HORSE_TEMPLE',	'KIND_BUILDING');

INSERT INTO Buildings 
	(BuildingType,					Name,									Description,										PrereqCivic,	PrereqTech,			Cost,		AdvisorType,			MaxWorldInstances,	IsWonder,	RequiresPlacement,	Quote,										QuoteAudio,							AdjacentDistrict,				ObsoleteEra,		AllowsHolyCity)
VALUES	
	('BUILDING_WHITE_HORSE_TEMPLE',	'LOC_BUILDING_WHITE_HORSE_TEMPLE_NAME',	'LOC_BUILDING_WHITE_HORSE_TEMPLE_DESCRIPTION',		NULL,			'TECH_CURRENCY',	400,		'ADVISOR_RELIGIOUS',	'1',				1,			1,					'LOC_BUILDING_WHITE_HORSE_TEMPLE_QUOTE',	'Play_WhiteHorseTemple_Quote_zh',	'DISTRICT_DIPLOMATIC_QUARTER',	'ERA_INDUSTRIAL',	1);


--如果是风云变幻，则额外有外交支持，需要更新描述
UPDATE Buildings SET Description = 'LOC_BUILDING_WHITE_HORSE_TEMPLE_DESCRIPTION_XP2' 
WHERE BuildingType = 'BUILDING_WHITE_HORSE_TEMPLE' AND EXISTS (SELECT * FROM GlobalParameters WHERE Name = 'DIPLOMATIC_VICTORY_POINTS_REQUIRED');

INSERT INTO Building_YieldChanges 
	(BuildingType,					YieldType,			YieldChange) 
VALUES	
	('BUILDING_WHITE_HORSE_TEMPLE',	'YIELD_FAITH',		2),
	('BUILDING_WHITE_HORSE_TEMPLE',	'YIELD_CULTURE',	1);

--测试时候用，移除相邻外交区，秦始皇喜欢造

--UPDATE Buildings SET AdjacentDistrict = NULL WHERE BuildingType = 'BUILDING_WHITE_HORSE_TEMPLE';
--
--DELETE FROM AiFavoredItems  WHERE ListType = 'QinWonders';
--INSERT INTO AiFavoredItems 
	--(ListType,		Item,							Favored)
--VALUES
	--('QinWonders', 'BUILDING_WHITE_HORSE_TEMPLE',	1);


INSERT INTO Building_ValidTerrains 
	(BuildingType,					TerrainType) 
VALUES	
	('BUILDING_WHITE_HORSE_TEMPLE',	'TERRAIN_GRASS'),
	('BUILDING_WHITE_HORSE_TEMPLE',	'TERRAIN_PLAINS'),
	('BUILDING_WHITE_HORSE_TEMPLE',	'TERRAIN_SNOW'),
	('BUILDING_WHITE_HORSE_TEMPLE',	'TERRAIN_TUNDRA'),
	('BUILDING_WHITE_HORSE_TEMPLE',	'TERRAIN_DESERT');


--获得大预言家
INSERT INTO BuildingModifiers 
	(BuildingType,					ModifierId) 
VALUES	
	('BUILDING_WHITE_HORSE_TEMPLE',	'BUILDING_WHITE_HORSE_TEMPLE_GRANT_PROPHET'),
	('BUILDING_WHITE_HORSE_TEMPLE',	'BUILDING_WHITE_HORSE_TEMPLE_ALTERNATE_GRANT_APOSTLE');


INSERT INTO Modifiers 
	(ModifierId,											ModifierType,												RunOnce,	Permanent,		NewOnly,	OwnerRequirementSetId,	SubjectRequirementSetId) 
VALUES	
	('BUILDING_WHITE_HORSE_TEMPLE_GRANT_PROPHET',			'MODIFIER_SINGLE_CITY_GRANT_GREAT_PERSON_CLASS_IN_CITY',	1,			1,				0,			NULL,					'REQSET_WHITE_HORSE_TEMPLE_GRANT_PROPHET'),
	('BUILDING_WHITE_HORSE_TEMPLE_ALTERNATE_GRANT_APOSTLE',	'MODIFIER_SINGLE_CITY_GRANT_UNIT_IN_CITY',					1,			1,				0,			NULL,					'REQSET_WHITE_HORSE_TEMPLE_GRANT_APOSTLE');

INSERT INTO ModifierArguments 
	(ModifierId,												Name,						Value) 
VALUES	
	('BUILDING_WHITE_HORSE_TEMPLE_GRANT_PROPHET',				'GreatPersonClassType',		'GREAT_PERSON_CLASS_PROPHET'	),
	('BUILDING_WHITE_HORSE_TEMPLE_GRANT_PROPHET',				'Amount',					1								),
	('BUILDING_WHITE_HORSE_TEMPLE_ALTERNATE_GRANT_APOSTLE',		'UnitType',					'UNIT_APOSTLE'					),
	('BUILDING_WHITE_HORSE_TEMPLE_ALTERNATE_GRANT_APOSTLE',		'Amount',					1								);


INSERT INTO RequirementSets
	(RequirementSetId,										RequirementSetType)
VALUES
	('REQSET_WHITE_HORSE_TEMPLE_GRANT_PROPHET',				'REQUIREMENTSET_TEST_ALL'),
	('REQSET_WHITE_HORSE_TEMPLE_GRANT_APOSTLE',				'REQUIREMENTSET_TEST_ALL');

INSERT INTO RequirementSetRequirements
	(RequirementSetId,										RequirementId)
VALUES
	('REQSET_WHITE_HORSE_TEMPLE_GRANT_PROPHET',				'REQUIRES_PLAYER_CAN_EVER_EARN_PROPHET'		),
	('REQSET_WHITE_HORSE_TEMPLE_GRANT_APOSTLE',				'REQUIRES_PLAYER_CAN_NOT_EVER_EARN_PROPHET'	);


--购买宗教单位返还信仰，传教返还文化，揭示佛教
INSERT INTO BuildingModifiers 
	(BuildingType,					ModifierId) 
VALUES	
	('BUILDING_WHITE_HORSE_TEMPLE',	'BUILDING_WHITE_HORSE_TEMPLE_ADJUST_PLAYER_PROPERTY_PURCHASE_RELIGIOUS_UNITS_BONUS'),
	('BUILDING_WHITE_HORSE_TEMPLE',	'BUILDING_WHITE_HORSE_TEMPLE_ADJUST_PLAYER_PROPERTY_SPREAD_RELIGION_BONUS'),
	('BUILDING_WHITE_HORSE_TEMPLE',	'BUILDING_WHITE_HORSE_TEMPLE_ADJUST_PLAYER_PROPERTY_REVEAL_RELIGION_BUDDHISM');

INSERT INTO Modifiers 
	(ModifierId,																			ModifierType,						RunOnce,	Permanent,		NewOnly,	OwnerRequirementSetId,	SubjectRequirementSetId) 
VALUES	
	('BUILDING_WHITE_HORSE_TEMPLE_ADJUST_PLAYER_PROPERTY_PURCHASE_RELIGIOUS_UNITS_BONUS',	'MODIFIER_PLAYER_ADJUST_PROPERTY',	0,			0,				0,			NULL,					NULL),
	('BUILDING_WHITE_HORSE_TEMPLE_ADJUST_PLAYER_PROPERTY_SPREAD_RELIGION_BONUS',			'MODIFIER_PLAYER_ADJUST_PROPERTY',	0,			0,				0,			NULL,					NULL),
	('BUILDING_WHITE_HORSE_TEMPLE_ADJUST_PLAYER_PROPERTY_REVEAL_RELIGION_BUDDHISM',			'MODIFIER_PLAYER_ADJUST_PROPERTY',	0,			0,				0,			NULL,					NULL);

INSERT INTO ModifierArguments 
	(ModifierId,																				Name,			Value) 
VALUES	
	('BUILDING_WHITE_HORSE_TEMPLE_ADJUST_PLAYER_PROPERTY_PURCHASE_RELIGIOUS_UNITS_BONUS',		'Key',			'WHITE_HORSE_TEMPLE_PURCHASE_RELIGIOUS_UNITS_BONUS_KEY'	),
	('BUILDING_WHITE_HORSE_TEMPLE_ADJUST_PLAYER_PROPERTY_PURCHASE_RELIGIOUS_UNITS_BONUS',		'Amount',		1														),
	('BUILDING_WHITE_HORSE_TEMPLE_ADJUST_PLAYER_PROPERTY_SPREAD_RELIGION_BONUS',				'Key',			'WHITE_HORSE_TEMPLE_SPREAD_RELIGION_BONUS_KEY'			),
	('BUILDING_WHITE_HORSE_TEMPLE_ADJUST_PLAYER_PROPERTY_SPREAD_RELIGION_BONUS',				'Amount',		1														),
	('BUILDING_WHITE_HORSE_TEMPLE_ADJUST_PLAYER_PROPERTY_REVEAL_RELIGION_BUDDHISM',				'Key',			'WHITE_HORSE_TEMPLE_REVEAL_RELIGION_BUDDHISM_KEY'		),
	('BUILDING_WHITE_HORSE_TEMPLE_ADJUST_PLAYER_PROPERTY_REVEAL_RELIGION_BUDDHISM',				'Amount',		1														);


--白马寺拥有者喜欢佛教
--佛教喜欢白马寺拥有者
INSERT INTO Modifiers
	(ModifierId,								ModifierType,									Permanent,	OwnerRequirementSetId,						SubjectRequirementSetId) 
VALUES
	('WHITE_HORSE_TEMPLE_LOVE_BUDDHISM',		'MODIFIER_PLAYER_DIPLOMACY_SIMPLE_MODIFIER',	0,			'REQSET_PLAYER_HAS_WHITE_HORSE_TEMPLE_WHT',	'REQSET_PLAYER_CREATED_BUDDHISM_MET_3_TURNS_AGO_WHT'),
	('BUDDHISM_LOVE_WHITE_HORSE_TEMPLE',		'MODIFIER_PLAYER_DIPLOMACY_SIMPLE_MODIFIER',	0,			NULL,										'REQSET_PLAYER_HAS_WHITE_HORSE_TEMPLE_MET_3_TURNS_AGO_WHT');

INSERT INTO ModifierArguments
	(ModifierId,								Name,							Value) 
VALUES
	('WHITE_HORSE_TEMPLE_LOVE_BUDDHISM',		'SimpleModifierDescription',	'LOC_DIPLO_MODIFIER_DESCRIPTION_WHITE_HORSE_TEMPLE_LOVE_BUDDHISM'),
	('WHITE_HORSE_TEMPLE_LOVE_BUDDHISM',		'StatementKey',					'LOC_DIPLO_KUDO_LEADER_ANY_REASON_WHITE_HORSE_TEMPLE_LOVE_BUDDHISM'),
	('WHITE_HORSE_TEMPLE_LOVE_BUDDHISM',		'InitialValue',					50),
	('WHITE_HORSE_TEMPLE_LOVE_BUDDHISM',		'HiddenAgenda',					1),

	('BUDDHISM_LOVE_WHITE_HORSE_TEMPLE',		'SimpleModifierDescription',	'LOC_DIPLO_MODIFIER_DESCRIPTION_BUDDHISM_LOVE_WHITE_HORSE_TEMPLE'),
	('BUDDHISM_LOVE_WHITE_HORSE_TEMPLE',		'StatementKey',					'LOC_DIPLO_KUDO_LEADER_ANY_REASON_BUDDHISM_LOVE_WHITE_HORSE_TEMPLE'),
	('BUDDHISM_LOVE_WHITE_HORSE_TEMPLE',		'InitialValue',					50),
	('BUDDHISM_LOVE_WHITE_HORSE_TEMPLE',		'HiddenAgenda',					1);


INSERT INTO ModifierStrings
	(ModifierId,								Context,			Text) 
VALUES
	('WHITE_HORSE_TEMPLE_LOVE_BUDDHISM',		'Sample',			'LOC_TOOLTIP_SAMPLE_DIPLOMACY_ALL'),
	('BUDDHISM_LOVE_WHITE_HORSE_TEMPLE',		'Sample',			'LOC_TOOLTIP_SAMPLE_DIPLOMACY_ALL');


INSERT INTO RequirementSets
	(RequirementSetId,												RequirementSetType)
VALUES
	('REQSET_PLAYER_CREATED_BUDDHISM_MET_3_TURNS_AGO_WHT',			'REQUIREMENTSET_TEST_ALL'),
	('REQSET_PLAYER_CREATED_BUDDHISM_WHT',							'REQUIREMENTSET_TEST_ALL'),
	('REQSET_PLAYER_HAS_WHITE_HORSE_TEMPLE_MET_3_TURNS_AGO_WHT',	'REQUIREMENTSET_TEST_ALL'),
	('REQSET_PLAYER_HAS_WHITE_HORSE_TEMPLE_WHT',					'REQUIREMENTSET_TEST_ALL');

INSERT INTO RequirementSetRequirements
	(RequirementSetId,												RequirementId)
VALUES
	('REQSET_PLAYER_CREATED_BUDDHISM_MET_3_TURNS_AGO_WHT',			'REQUIRES_MET_3_TURNS_AGO_WHT'					),
	('REQSET_PLAYER_CREATED_BUDDHISM_MET_3_TURNS_AGO_WHT',			'REQUIRES_PLAYER_LOVE_BUDDHISM_IN_HISTORY_WHT'	),
	('REQSET_PLAYER_CREATED_BUDDHISM_WHT',							'REQUIRES_PLAYER_CREATED_BUDDHISM_WHT'			),

	('REQSET_PLAYER_HAS_WHITE_HORSE_TEMPLE_MET_3_TURNS_AGO_WHT',	'REQUIRES_MET_3_TURNS_AGO_WHT'					),
	('REQSET_PLAYER_HAS_WHITE_HORSE_TEMPLE_MET_3_TURNS_AGO_WHT',	'REQUIRES_PLAYER_HAS_WHITE_HORSE_TEMPLE_WHT'	),

	('REQSET_PLAYER_HAS_WHITE_HORSE_TEMPLE_WHT',					'REQUIRES_PLAYER_HAS_WHITE_HORSE_TEMPLE_WHT'	);


INSERT INTO Requirements 
	(RequirementId,										RequirementType)
VALUES 
	('REQUIRES_MET_3_TURNS_AGO_WHT',					'REQUIREMENT_PLAYER_MET_X_TURNS_AGO'				),
	('REQUIRES_PLAYER_HAS_WHITE_HORSE_TEMPLE_WHT',		'REQUIREMENT_PLAYER_HAS_BUILDING'					),
	('REQUIRES_PLAYER_CREATED_BUDDHISM_WHT',			'REQUIREMENT_PLOT_PROPERTY_MATCHES'					),
	('REQUIRES_PLAYER_LOVE_BUDDHISM_IN_HISTORY_WHT',	'REQUIREMENT_REQUIREMENTSET_IS_MET'					);

	--REQUIREMENT_PLAYER_HAS_AT_LEAST_NUM_BUILDINGS 不生效
	--REQUIREMENT_PLAYER_HAS_BUILDING 至少要迭起兴衰

INSERT INTO RequirementArguments 
	(RequirementId,										Name,				Value)
VALUES 
	('REQUIRES_MET_3_TURNS_AGO_WHT',					'TurnsAgo'	,			3												),
	('REQUIRES_PLAYER_HAS_WHITE_HORSE_TEMPLE_WHT',		'BuildingType',			'BUILDING_WHITE_HORSE_TEMPLE'					),
	
	('REQUIRES_PLAYER_CREATED_BUDDHISM_WHT',			'PropertyName',			'WHITE_HORSE_TEMPLE_PLAYER_CREATED_BUDDHISM'	),
	('REQUIRES_PLAYER_CREATED_BUDDHISM_WHT',			'PropertyMinimum',		1												),
	('REQUIRES_PLAYER_LOVE_BUDDHISM_IN_HISTORY_WHT',	'RequirementSetId',		'REQSET_PLAYER_LOVE_BUDDHISM_IN_HISTORY_WHT'	);

	--('REQUIRES_PLAYER_HAS_WHITE_HORSE_TEMPLE_WHT',		'Amount',				1												),
	
--历史上喜欢佛教的领袖
INSERT OR REPLACE INTO RequirementSets
	(RequirementSetId,										RequirementSetType)
VALUES
	('REQSET_PLAYER_LOVE_BUDDHISM_IN_HISTORY_WHT',			'REQUIREMENTSET_TEST_ANY');

INSERT OR REPLACE INTO RequirementSetRequirements
	(RequirementSetId,										RequirementId)
SELECT
	'REQSET_PLAYER_LOVE_BUDDHISM_IN_HISTORY_WHT',			'REQUIRES_LEADER_IS_'|| LeaderType || '_WHT'
FROM Leaders WHERE LeaderType IN ('LEADER_HOJO', 'LEADER_TOKUGAWA', 'LEADER_KUBLAI_KHAN_CHINA', 'LEADER_KUBLAI_KHAN_MONGOLIA', 'LEADER_JAYAVARMAN', 'LEADER_SEONDEOK', 'LEADER_WU_ZETIAN');

INSERT OR REPLACE INTO Requirements 
	(RequirementId,										RequirementType)
SELECT
	'REQUIRES_LEADER_IS_'|| LeaderType || '_WHT',		'REQUIREMENT_PLAYER_TYPE_MATCHES'	
FROM Leaders WHERE LeaderType IN ('LEADER_HOJO', 'LEADER_TOKUGAWA', 'LEADER_KUBLAI_KHAN_CHINA', 'LEADER_KUBLAI_KHAN_MONGOLIA', 'LEADER_JAYAVARMAN', 'LEADER_SEONDEOK', 'LEADER_WU_ZETIAN');

INSERT OR REPLACE INTO RequirementArguments 
	(RequirementId,										Name,				Value)
SELECT
	'REQUIRES_LEADER_IS_'|| LeaderType || '_WHT',		'LeaderType',		LeaderType	
FROM Leaders WHERE LeaderType IN ('LEADER_HOJO', 'LEADER_TOKUGAWA', 'LEADER_KUBLAI_KHAN_CHINA', 'LEADER_KUBLAI_KHAN_MONGOLIA', 'LEADER_JAYAVARMAN', 'LEADER_SEONDEOK', 'LEADER_WU_ZETIAN');


--挂给主流文明，要求有建筑
INSERT INTO  TraitModifiers
	(TraitType,						ModifierId)
VALUES	
	('TRAIT_LEADER_MAJOR_CIV',		'WHITE_HORSE_TEMPLE_LOVE_BUDDHISM');

--直接挂给建筑，会出对话，但是不显示好感度
--INSERT INTO BuildingModifiers 
	--(BuildingType,					ModifierId) 
--VALUES	
	--('BUILDING_WHITE_HORSE_TEMPLE',	'WHITE_HORSE_TEMPLE_LOVE_BUDDHISM');

--挂给主流文明Req首都好像没用
--INSERT INTO  TraitModifiers
	--(TraitType,						ModifierId)
--VALUES	
	--('TRAIT_LEADER_MAJOR_CIV',		'BUDDHISM_LOVE_WHITE_HORSE_TEMPLE');


--现在挂给喜欢佛教的领袖

INSERT INTO  TraitModifiers
	(TraitType,					ModifierId)
SELECT
	TraitType,					'BUDDHISM_LOVE_WHITE_HORSE_TEMPLE'
FROM Traits WHERE TraitType IN ('TRAIT_LEADER_DIVINE_WIND','TRAIT_LEADER_TOKUGAWA', 'TRAIT_LEADER_KUBLAI', 'TRAIT_LEADER_MONASTERIES_KING', 'TRAIT_LEADER_HWARANG', 'TRAIT_LEADER_WU_ZETIAN');